---
title: 翻译
top: false
cover: true
toc: true
mathjax: true
date: 2019-10-14 00:33:55
password:
summary:
tags:
categories:
---

# 7.1 概述

根据线上社交网络的屏幕快照，推测丢失的链接，或是将来在网络中会形成的链接的问题被称为链接预测问题。 链接预测问题在现实世界中有着具体的应用，并且许多具体的服务可用于链接预测问题。 例如，可以将线上社交网络中的好友推荐问题建模为用户之间的友谊链接预测问题。 用户轨迹预测问题可表述为用户与线下POI（兴趣点）之间潜在的签到链接的预测任务。 跨网络的用户标识符解析问题（即在前几章中介绍的网络对齐问题）可以建模为横跨不同在线社交网络的用户帐户的锚链接预测问题。

在本章中，我们将以友谊链接为例，介绍在线社交网络中的一般链接预测问题。 形式上，给定包含链接的训练集Ttrain属于不同类别（Y = {+ 1，-1}，其中+1表示正类别，而-1表示负类别；有时我们也使用0表示负类别） 和测试集Ttest（带有未知标签的链接），链接预测问题旨在建立映射f：Ttrain∪Ttest→Y，以将这些链接映射到其潜在标签Y中。
根据我们研究链接预测问题的场景，可以将现有的链接预测工作划分为多个不同的类别。传统的链接预测问题主要集中于推断单同质网络中的链接，例如，推断在线社交网络中用户之间的友谊链接，以及著作网络中共同作者的链接。随着网络结构变得越来越复杂，我们可以将许多复杂的网络结构建模为涉及不同类型节点以及节点之间复杂连接的异质网络。网络的异质性导致了许多新的链接预测问题，例如预测属于不同类别的节点之间的链接，以及异质网络中多种类型的链接的并发推断。近年来，出现了许多在线社交网络，也有着许多新的研究机会，让研究人员和从业人员可以从跨网络的角度研究链接预测问题。

同时，根据用于链接预测问题公式和模型中的**学习（设置？背景？环境？）**，可以根据在模型构建过程中涉及的监督信息将现有的链接预测工作分为不同的类别。对于某些链接预测模型，这些模型计算一对用户间的紧密中心度作为链接预测结果，且不使用任何训练数据，这类模型称为无监督链接预测模型。 而对于另一些模型，他们会为链接分配不同的标签，并将其作为训练集，以此用来学习监督分类模型作为基础模型。这类模型称为监督链接预测模型。通常，手动标记链接非常昂贵且乏味。近年来，许多工作提出了在链接预测问题中应用半监督学习技术，以利用没有标签的链接。

在本章中，我们将介绍在线社交网络中的社交链接预测问题。在第7.2节中，我们将介绍在单同质社交网络中的社交链接预测工作，这些模型包括无监督模型，基于分类的监督模型和基于矩阵分解的链接预测模型。异质网络中的链接预测工作将在第7.3节中介绍，包括监督链接预测模型和多种类型的链接预测任务。在以下各节中，我们将讨论跨多个异质社交网络的链接预测问题。在第7.4节中，我们介绍了一种新颖的跨网络社交链接预测模型，专门用于预测新用户的社交链接。在第7.5节中，我们将重点介绍利用正样本无标签（PU）学习模型的社交链接预测模型。最后，为了克服域差异问题，在第7.6节中，我们将介绍基于矩阵估计的，具有正样本无标签链接的社交链接预测模型。

# 7.2 传统的单一同质网络链接预测

传统的链接预测问题主要是基于一个单同质网络来研究的，涉及一种单一类型的节点和链接。 在本节中，我们将首先简要介绍如何将在3.3.3节中介绍的社交紧密性度量用于链接预测任务。为了将社会亲密性度量整合起来进行链接预测，我们将介绍监督链接预测模型。一些模型将链接预测任务表述为推荐问题，并提出应用矩阵分解方法解决该问题。在本节中，我们将介绍三种用于传统单同质网络的链接预测模型。

## 7.2.1 无监督链接预测

给定同质网络G =（V，E）的屏幕快照，此处介绍的无监督链接预测模型旨在推断将来可能会形成的潜在链接。通常，无监督链接预测模型将为链接计算一些度量，这些度量将用作这些链接的预测置信度分数。根据特定的场景和所应用的链接形成假设，已经提出了针对链接预测任务的不同度量标准。

许多链接预测度量都是基于“近的用户更可能成为朋友”的假设，并使用社交紧密中心度作为链接预测置信度得分。3.3.3节中介绍的社交紧密中心度，例如局部紧密中心度（例如，共同邻居，Jaccard系数，Adamic/Adar），基于全局路径的紧密中心度（例如，最短路径，Katz），以及基于随机游走的紧密中心度（例如，击中时间，通勤时间和余弦相似性）都可以用来推断用户之间的潜在连接。
在这一部分中，我们将不再讨论这些度量，读者可以参考之前的章节以获取更多信息。接下来，我们将介绍针对使用无监督学习模型的链接预测问题的一般*学习设置*和评估指标。

### 7.2.1.1 无监督链接预测问题设定（？）

假设在网络 *G = (V，E)* 中，每个链接都与一个时间戳关联。例如，对于链接 *e ∈ E*，我们可以将链接e的形成时间戳记为 *t(e)*。 给定三个时间点 *tp < tc < tf*, 表示过去的时间点 *tp*，当前的时间点*tc*和将来的时间点*tf*，我们可以分别检索在时间范围 [tp，tc] 中形成的网络结构作为当前网络 *G(tp,tc)* ，和在未来时间范围 *(tc，tf]* 内形成的网络结构作为未来网络 *G(tc,tf)*。当前网络可以用作链接预测算法的输入，即 *G(tp,tc)*，它可以推断在未来时间范围 *(tc，tf]* 中会形成的新连接，即未来网络结构 *G(tc,tf)*。

随着网络结构的演化，新的链接和新的节点都将会形成。 但是，对于一个在时间范围 *(tc，tf]* 内加入网络的新节点，我们没有关于它的历史知识，也几乎无法预测与这些新节点有关联的链接，这也被称为冷启动问题。通常，在链接预测问题中，我们将节点的一个子集作为核心集 *Vc ⊂ V*，并且我们将集中研究仅与核心集中的节点相关的链接。对于在时间范围 *(tc，tf)* 中形成的所有新链接，我们只对与核心集中的节点相关的链接进行采样，来研究链接预测问题，对于有关新用户的冷启动链接预测问题，我们将在第7.4节中专门解决。

给定当前的网络结构 *(Gtp,tc)* 和核心集 *Vc*，我们可以将核心集用户之间形成的链接表示为集合Ec(tp,tc) = E(tp,tc) ∩ Vc × Vc。 同时，核心集用户之间的其余链接可以表示为集合 Er(tp,tc) = Vc × Vc \ ({{(u,u)}u∈Vc ∪ Ec(tp，tc))。 链接预测模型旨在推断出：“在Er(tp，tc)中的所有链接中，哪个链接将在时间范围 *(tc，tf]* 中形成并在未来的网络结构 *G(tc,tf)* 中出现。(即，在集合Ec(tc,tf) = E(tc,tf) ∩ Vc × Vc 中)

### 7.2.1.2 无监督链接预测模型

在无监督的链接预测模型中，我们基于“紧密的用户倾向于成为朋友”的假设，使用社交紧密中心度作为预测置信度度量。在表7.1中，我们总结了之前介绍的一些紧密中心度度量。例如，如果我们使用“公共邻居”作为社交紧密中心度度量，则可以将集合Er(tp,tc)中所有用户对的紧密度得分表示为 {C(e)}e∈Er(tp,tc)。

所有这些剩余链接的分数，即{C(e)}e∈Ertp，tc，可以作为结果输出。同时，当决定要推荐给核心集中的每个用户的链接时，我们可以选择预测得分最高的前k个链接，或者设置阈值以选择得分大于阈值的链接作为待形成的链接。换句话说，这些选定的链接将分配有正标签，而其余未选择的链接将分配有负标签。

### 7.2.1.3 无监督链接预测结果评估

给定集合 Er(tp,tc) 中所有剩余的链接以及未来网络 *G(tc,tf)* 中新形成的链接，我们可以将其真实标签表示为向量y∈{-1，+ 1} | Er tp，tc |×1。 对于未来网络 *G(tc,tf)* 中形成的所有链接，我们可以将它们分配为标签 + 1，而对于其余的链接，它们将分配为标签-1。

给定计算出的分数，例如{C（e）}e∈Ertp，tc和真实标签向量，我们可以通过计算AUC分数（即ROC曲线下的面积）来评估链接预测模型的性能 )。 在所有链接中，我们可以选择前k个链接，也可以使用nDCG @ k等指标来评估预测结果。

同时，如果选择前k个链接分配标签，则链接预测模型的输出将是这些链接的预测标签。通过将它们与真实标签向量进行比较，可以计算出诸如精度，召回率，F1和准确性（前k位）的度量作为性能评估结果。

## 7.2.2 监督链接预测

在某些情况下，网络中的链接被明确地分为不同的组，例如表示朋友的链接vs表示敌人的链接，朋友（有连接）vs陌生人（无连接）。给定一组带标签的链接，例如一个包含不同类别链接的集合E，其中，监督链接预测问题旨在建立监督学习模型来解决链接预测问题。学习的模型将用于确定测试集中的链接标签。在这一小节中，我们仍然以链接形成问题为例来阐述有监督的链接预测模型。

### 7.2.2.1 监督链接预测问题设定

给定网络结构 G =（V，E），集合E中包含已形成的链接，我们可以将网络G中用户之间的所有潜在链接表示为集合 L = V×V \ {（u，u）}u∈V\ E。这些现有的链接可以标记为正训练集，而集合L的链接子集被鉴定为永远不会形成的链接，可以将其表示为Ln ⊂ L并标记为负训练集。这些带有正负标签的链接可以视为训练集，即Ltrain = E ∪ Ln，其余带有未知标签的链接可以用作测试集Ltest = L \ Ln。 在监督链接预测问题中，我们旨在通过训练集合Ltrain构建监督分类/回归模型，并应用习得的模型来推断测试集Ltest中的链接标签。

### 7.2.2.2 监督链接预测特征抽取

为了表示每个社交链接，例如节点u和v之间的链接l =（u，v）∈E，将在模型构建过程中抽取一组特征，这组特征可以表示链接 l 以及节点u，v的属性。通常，在预测任务中，这些可以为链接抽取的特征可以分为两类：

* 节点特征：节点的属性可以用第3.3节介绍的方法来表示，像是各种节点中心度度量。例如，对于链接（u，v），基于训练集中的已知链接，我们可以根据度，归一化度，特征向量，Katz，PageRank，节点u和v的中间性，来计算中心度度量作为链接（u,v）的特征的一部分，并可以分别表示为向量xu和xv。

* 链接特征：网络中链接的属性可以通过计算节点的节点之间的紧密度得到。例如，对于链接（u，v），基于训练集中的已知链接，我们可以根据共同邻居，Jaccard系数，Adamic / Adar，最短路径，Katz，击中时间，通勤时间等，来计算紧密度度量作为节点u和v之间作为链接（u,v）的特征，并在形式上可以表示为向量x(u，v)。

我们可以将节点u,v的特征与链接（u,v）的特征加在一起，将链接l=(u,v)的抽取特征向量表示为长度k的向量 xl。

### 7.2.2.3 监督链接预测模型

利用训练集Ltrain，我们可以将Ltrain中链接的特征向量和标签表示为训练数据{（xl，yl）}l∈Ltrain。 同时，利用测试集Ltest，我们可以将测试集中链接的抽取特征表示为{xl}l∈Ltrain **（test?）**。我们可以使用不同的分类模型作为链接预测任务的基础模型，例如在第2.3节中介绍的决策树模型，人工神经网络模型和支持向量机（SVM）模型。这些模型可以用训练数据来训练，并且可以通过将模型应用于测试数据实例来确定测试集中的链接标签。
根据所应用的特定模型，链接预测结果的输出可以包括（1）Ltest中链接的预测标签，以及（2）Ltest中链接的预测置信度分数/概率分数。

### 7.2.2.4 监督链接预测结果评估

不同的评估指标可用于度量链接预测模型的性能。对于产生测试集预测标签的模型，诸如精度，召回率，F1和准确性之类的评估指标可以用于性能评估。同时，对于将置信度得分列表作为输出的模型，可以将诸如AUC和Precision @ k，nDCG @ k之类的评估指标用于性能评估。对于上述这些指标，较高的评估分数将对应于更好的链接预测性能。

## 7.2.3 基于矩阵分解的链接预测

除了无监督和监督链接预测模型，许多其他基于矩阵分解的方法也可应用于解决同质网络中链接预测任务。

### 7.2.3.1 基于矩阵分解的链接预测设定

给定同质的社交网络G =（V，E），以及集合E包含用户间现有的社交链接，则用户之间剩余的潜在链接可以表示为L = V × V \ {（u，u）}u∈V\ E。集合E中的链接是已形成的链接，可以标记为正例，而集合L中的那些链接既包含将会形成的链接，也包含那些永远不会形成的链接（即，包含正负链接），应不加标签。

可用的训练集涉及集合E中标记为正的链接和集合L中未被标记的链接。测试集为未标记的集合L，我们的目标是通过基于矩阵分解的方法来推断这些潜在链接的标记。

### 7.2.3.2 基于矩阵分解的链接预测模型

形式上，给定同质社交网络G =（V，E）以及集合E中存在的用户之间的社交链接，我们可以将这些链接组织到社交邻接矩阵 A∈{0,1} | V |×| V |中。 给定网络G的邻接矩阵A，可以使用低秩紧凑表示矩阵U∈R | V |×d，d <| V |来存储网络中每个用户的社交信息。矩阵U可以通过求解以下优化目标函数来获得：

（公式7.1）

其中U是低秩矩阵，矩阵V包含矩阵U行与行之间的相关性，||·||F 表示矩阵的Frobenius范数。

为了避免过拟合，如下所示给目标函数加上正则项||U||2F 和 ||V||2F

（公式7.2）

其中α和β分别是||U||2F 和 ||V||2F项的权重。

这个目标函数非常难以同时达到U和V的全局最优解。我们可以在这里使用一个替代的优化方案，这个方案可以交替更新U和V。 目标方程的拉格朗日函数为：

公式（7.3）

其中 θ 和 Ω 分别是约束U和V的乘子
通过将F分别对U和V求导，则F的偏导数为

（公式7.4， 7.5）

令偏导为0，并使用KKT补充条件，我们可以得到：

（公式7.6， 7.7）

低位矩阵U从邻接矩阵捕获每个用户的信息。矩阵U可以以不同的方式使用。 例如，U的每一行代表网络中用户的潜在特征向量，其可以用在许多链接预测模型中，例如监督链接预测模型。同时，基于从模型中学到的矩阵V，我们也可以将链接（u，v）的预测得分表示为UuVUvT，其中符号Uu和Uv分别代表矩阵U中对应于用户u和v的行。

### 7.2.3.3 基于矩阵分解的链接预测结果评估

给定未标记集L中链接的真实标签和相应的推断得分，该得分基于从模型中习得的矩阵U和V得到，我们可以使用AUC，Precision @ k和nDCG @k等指标来评估模型的性能k。在本章末的练习中，我们将要求读者尝试使用偏好的编程语言来实现上述链接预测算法，并比较它们在推断同质网络中的社交链接时的性能。

# 7.3 异质网络集体链接预测

具有单一类型节点/链接的同质网络是一种非常简单的网络表示形式。在现实世界的在线社交网络中，通常存在许多不同类型的节点，例如用户，线下POI，帖子。用户还可以执行各种操作，例如关注其他用户并在某些地方签到，这将在这些节点之间创建非常复杂的连接。正式地，对于具有这种复杂结构的在线社交网络，它们称为异质信息网络。现实世界中存在着各种各样的在线社交网络。在本节中，我们将主要关注提供地理服务的在线社交网络，即基于位置的社交网络（LBSN），并研究基于LBSN的集体链接预测任务。

## 7.3.1 LBSNs简介

基于位置的社交网络（LBSNs）是一种可以提供地理服务（例如，位置签到和发布评论）的在线社交网络，并且近年来引起了很多关注。LBSNs通常具有非常复杂的结构，包括多种类型的节点（例如，用户，位置等）以及这些节点之间的不同类型的链接（例如，用户之间的社交链接以及用户和位置之间的位置链接）。例如，Foursquare是一个主流的LBSN。它涉及数百万个用户和位置。Foursquare用户可以添加朋友，使用手机在不同位置签到，撰写评论并与朋友分享位置。

LBSNs提供的许多重要服务可以转化为链接预测问题。例如，好友推荐涉及预测用户之间的社交链接；位置推荐旨在预测用户和位置之间的位置链接。LBSNs可以从高质量的社交链接和位置链接预测结果中受益匪浅。原因是建立良好的社交关系可以提高用户对社交网络的参与度。同时，在基于位置的社交网络中，高质量的预测位置链接可以提高网络中位置服务的价值。

关于LBSNs的常规链接预测研究主要集中于预测社交链接或位置链接，并且通常假设不同类型链接的预测任务是独立的。然而，在许多现实世界的LBSNs中，社交链接和位置链接的链接预测任务之间有着很强的相关性并且相互影响。例如，如果两个用户是彼此的朋友，则他们更有可能在相似的位置签到。 因此，如果我们可以进行准确的友谊预测，则可以大大提高位置推荐的性能。同样，如果两个用户经常在相似的位置签到，那么他们在现实生活中更有可能彼此认识并结交朋友。从这个角度来看，如果我们可以进行准确的位置链接预测，则可以大大提高好友推荐的性能。

## 7.3.2 集体链接预测

在本节中，我们将研究LBSNs的集体链接预测问题，要预测的链接包括社交链接和位置链接。 由于LBSN中的社交链接和位置链接是相关的而不是独立的，因此解决该问题非常困难。社交链接和位置链接的预测任务应该要同时考虑。许多现有的工作主要集中在预测LBSNs中单个类型的链接，而没有考虑不同链接预测任务之间的相关性。

在下面的部分中，我们将介绍有监督的集体链接转移方法TRAIL（跨LBSN的转移异质链接），以解决上述挑战。 TRAIL可以从具有签到位置的在线帖子中累积位置的辅助信息，并可以为社交链接和位置链接提取异质特征。TRAIL可以同时预测社交链接和位置链接。

令 G =（V，E）为本节研究的网络，其中V = ∪i(Vi)为不同类型节点的并集，Vi，i∈{1,2，...，}为第i个类型的节点集合。 E = ∪j(Ej)是V中节点之间的链接集的并集，Ej，{1,2，...}是第j个类型的链接集。特别地，对于一个LBSN，节点集V =U∪L∪T∪W是用户，位置，时间和话语的节点集的并集。链接集E =Es∪El∪Et∪Ew是链接集的并集，包括社交友情链接，以及用户之间的位置签到，活动时间和发布的话语之间的链接。

给定具有现有的社交链接Es和位置链接El的LBSN G =（V，E），在研究的网络中，我们希望预测的是G用户之间潜在社交链接的子集：Ls⊂（U × U \ Es），以及G中潜在的位置签到链接的子集：Ll⊂（U × L \ El）。换句话说，我们要建立一个映射：f：{Ls，Ll} → {− 1,1}来确定{Ls，Ll}中的潜在链接是否存在以及表示它们的存在概率的置信度得分函数P：{Ls，Ll} → [0,1]。 在以下部分中，我们将详细介绍有监督的集体链接转移方法TRAIL，以解决该问题。

## 7.3.3 信息积累与特征抽取

TRAIL基于有监督的学习设定，因此，我们需要使用网络中的异质信息为社交链接和位置链接提取特征。与用户稍有不同，在线社交网络中的位置无法自行生成信息。在介绍特征抽取之前，我们将首先介绍用于积累位置信息的方法。

### 7.3.3.1 位置信息积累

在研究的问题中，位置以（纬度，经度）对表示，除与网络中用户的位置链接外，位置信息无辅助信息。因此，在提取用户与位置之间的位置链接的异质特征时，我们将面临缺少辅助信息的问题。事实上，我们注意到，用户可以在某些位置发布线上帖子，可以将在具体某个位置签到的在线帖子的文本内容和时间戳信息作为该位置拥有的辅助信息进行累积。

从统计角度来看，在某个位置发布的帖子中的信息（包括时间戳和文本内容）可以揭示该位置的某些属性。 例如，发布在夜生活场所的大多数帖子的时间戳记是在下午6:00之后。而在提供午餐的餐厅发布的帖子则是在白天。在国家公园发布的帖子可能包含一些描述场景的短语，而在篮球场发布的帖子可能主要是在谈论比赛，球队和球员。因此，我们可以从在线帖子累积的信息中了解更多有关位置的信息。

*例 7.1* 例如，在图7.1中，我们有两个完全不同的位置：林肯公园动物园和猩红酒吧。林肯公园动物园是芝加哥最大的免费动物园，开放时间为10:00 AM–5：00 PM。 猩红酒吧是芝加哥最著名的酒吧之一，人们可以在这里与朋友喝酒和跳舞以享受夜生活，并且在8:00 PM–2：00 AM营业。

我们也有4条人们在Foursquare或推特上在这两个地方发布的在线帖子。从这些帖子的内容中，我们发现人们通常在林肯公园动物园发表有关动物，图片和场景的文字。 但是，访问猩红酒吧的人们主要谈论酒吧的氛，饮料，地板和那里的音乐。因此，经常在日常生活中谈论动物的用户可能会对林肯公园动物园感兴趣，而那些经常发表有关饮料的话语的用户可能会更喜欢猩红酒吧。同时，我们也可以累积在这两个地方发布的帖子的时间戳。 在林肯公园动物园上发布的帖子的时间戳大多在白天，而在猩红酒吧上发布的时间戳则在晚上。因此，通常在白天活动的用户更有可能访问林肯公园动物园，而在夜间活动的用户可能更喜欢酒吧。

### 7.3.3.2 异质特征

基于网络中的异质信息，我们将从网络中的异质信息提取社交链接和位置链接的4种不同类别的特征，包括社交特征，空间分布特征，文本使用特征和时间分布特征。表7.2中提供了常用特征的概括，其中||X||p = (∑|x|i=1 |xi|^p)^(1/p) 表示向量x的Lp-范数

* 社交链接特征：对于某一社交链接（ui, uj），我们可以从网络中得到其邻居，可以分别表示为集合Γ(ui)和Γ(uj)。基于Γ(ui)，我们可以为ui构建社交链接权重向量~s(ui)，其中~s(ui) = (p(1,i), p(2,i),...,p(k,i),...,p(n,i))T ，n = |u|是用户集大小，p(k,i)是链接(uk,ui)的权重，∀uk ∈ u: 如果 uk ∈ (U \ Γ (ui)), 则 pk,i = 0.0; 如果 uk ∈ Γ(ui) 且 链接(uk,ui)起初就存在，则p(k,i) = 1.0; 否则， p(k,i)就是链接(uk,ui)的存在概率，类似地， 我们可以构建为用户uj构建与~s(ui)长度相等的向量~s(uj)。从~s(ui)和~s(uj)，我们可以为链接(ui,uj)抽取7个不同的社交特征，概括于表7.2中。

    以类似的方式，对于特定的社交链接（ui，uj），我们可以获得用户ui和uj访问的位置集作为集合Φ（ui）和Φ（uj），从中我们可以获得他们的位置链接权重向量为〜l（ui）和〜l（uj），其中条目表示这些用户访问位置的时间。从用户发布的帖子的时间戳中，我们可以获得用户的活动模式。每天分为24个时段，用户u在每小时中发布的在线帖子的比例保存在长度为24的时间分布向量〜t（u）中。对于社交链接（ui，uj），我们可以构建时间分布矢量：ui和uj的〜t（ui）和〜t（uj）。另外，我们将两个用户ui和uj使用的语句转换为两个长度相同的文本使用向量：TF-IDF加权的〜w（ui）和〜w（uj）。从这些向量中，我们可以提取类似于表7.2中针对社交链接（ui，u j）总结的社交链接特征的空间分布特征，时间分布特征和文本使用特征。

* 位置链接特征：同样，我们可以获得访问过某个地点的用户集，并将其视为该地点的“邻居”。对于位置链接（ui，lj），我们可以得到ui和lj的邻居集为Γ（ui）和Ψ（lj），从中我们可以分别构建社交链接权重向量~s（ui）和~s（lj）。根据位置的文本和时间戳累积信息以及用户拥有的辅助信息，我们还可以为位置链接（ui，lj）构建时间分布向量〜t（ui）和〜t（lj）以及文本用法向量〜w（ui）和〜w（lj）。从这些向量中，我们可以提取位置链接（ui，lj）的社交特征，时间分布特征和文本使用特征。

    此外，根据之前的定义，我们可以得到用户u以前访问过的位置：Φ(u) ，用户u的的位置链接权重向量~l(u)以及位置l的邻居Ψ(l)和其社交链接权重向量：~s(l)。对于某个特定的链接(ui,lj)，我们为网络中的位置链接抽取了三个空间分布特征：
    
    （1） Φ(ui)中位置与lj之间的加权平均距离：
    
    公式（7.8）

    其中GeoD(lk,lj)是lk和lj之间的几何距离（例如曼哈顿距离），~l(ui)lk是保存在ui的位置链接(ui,lk)权重向量中的权重。

    （2）曾访问过Φ(ui)中位置与lj的加权用户数

    公式（7.9）

    （3）曾访问过Φ(ui)中位置与lj的平均加权用户数

    公式（7.10）

## 7.3.4 集体链接预测模型

在本节中，我们将分析和公式化社交链接预测任务与位置链接预测任务之间的相关性，并引入一个集成的集体链接预测框架来同时解决这两个任务。

### 7.3.4.1 不同任务的相关性

当使用之前介绍的监督链接预测模型预测链接时，分类器将给出范围为[0,1]的分数，以显示其存在概率。新预测的社交链接将会更新网络中的社交链接存在概率信息，这可能会影响其他位置链接的预测。例如，这些更新的社交链接的存在概率可以改变位置和用户的扩展公共邻居，并且可以进而改变预测结果。类似地，位置链接预测任务也会影响社交链接预测结果。

*例 7.2* 例如，在图7.2中，我们显示了不同链接预测方法的示例。图7.2a是输入对齐网络，其中有4个用户以及一些现有的社交链接（u3，u4），（u1，u4）和位置链接（u2，l1），（u3，l1），（u1，l2 ），（u1，l3）以及许多其他可能的潜在链接。基于网络中的信息，包括社交信息（例如，共同邻居），位置信息（例如，共同签到）和其他辅助信息，传统的链接预测方法可以独立地预测社交链接和位置链接。图7.2b显示了独立的社交链接预测结果，其中社交链接（u2，u3）和（u1，u3）被预测为正（即存在），而其他两个社交链接（u1，u2）和（u2，u4）被预测为不存在。图7.2c展示了独立的位置链接预测结果，结果中位置链接（u2，l2），（u1，l1），（u4，l3）预测为正（即存在），而（u2，l3）和（u3，l3）被预测为负（即不存在）。

从图7.2b，c中的结果，我们可以发现一些有问题的现象。例如，预测用户u2和u1将访问位置l1，l2，并且还预测它们将共享一个公共邻居：u3。根据结果，这两个用户很可能会彼此认识，并且潜在的社交链接（u2，u3）将被预测为存在。 但是，根据独立的预测结果，如图7.2b所示，这个链接被预测为不存在。另一个例子是，用户u3的许多邻居，包括最初存在的u4和新预测的u1，都已经访问或被预测访问过l3。基于这样的观察，很可能预测u3已经访问过l3。 然而，在图7.2c中预测u3和l3之间的位置链接不存在。

如果同时考虑这两个链接预测任务之间的相关性，则很可能将社交链接（u1，u2）和位置链接（u3，l3）的预测结果预测为存在。 在图7.2d中，我们展示了集体链接预测方法可能的结果，其中社交链接和位置链接的预测结果似乎更加一致。

### 7.3.4.2 集体链接预测

如前所述，在问题公式化部分，我们将要预测的潜在社交链接和潜在位置链接的集合分别表示为Ls⊂（U × U \ Es）和Ll ⊂（U × L \ El）。对于链接ls ∈ Ls和ll ∈ Ll，使用网络中现有信息构建的监督模型将给予它们预测的标签：y（ls）和y（ll），以及存在概率得分：P（y（ls）= 1）和P（y（ll）= 1）。传统的预测社交链接和位置链接的方法独立地旨在找到一组标签，以得到每种链接的最大似然分数。换句话说，如果令ˆYs⊂{-1,1} | Ls |，ˆ Yl⊂{-1,1} | Ll | 是最优标签集，则社交和位置链接预测任务的目标函数可以表示为

公式（7.11，7.12）

其中 P(y(Ls)=ys)和P(y(l1)=y1)表示当Ls和L1中的链接被分配ys和yl标签时的概率分数。

但是，考虑到这两个链接预测任务之间的联系，推断的社交链接或位置链接信息应合并到同一框架中。 联合的最优标签集ˆ Ys和ˆ Yl为

公式（7.13）

对于给定的优化方程，有许多不同的解决方案。在这一部分中，我们将给出一种迭代方法TRAIL来解决这个问题，它可以迭代地预测社交链接和位置链接，直到收敛为止。令τ是第τ次迭代，在τ次迭代中获得的最佳社交链接和位置链接的标签集是^ys(τ)和^yt(τ)，则

公式（7.14，7.15）

TRAIL的伪代码在算法1。这里，我们主要关注于提供TRAIL的总体框架，但未指定要使用的分类器模型。实际上，我们之前介绍的任何分类算法（例如SVM，神经网络）都可以用作框架中的基本分类器。

（算法1）

# 7.4 对于新用户的冷启动链接预测

在本节中，我们研究为刚创建了帐户不久的新用户预测社交链接的问题。通常，刚创建帐户的新用户更可能接受建立社交社区的推荐。但是，这些新用户的有限可用信息可能对好友的高质量推荐提出巨大挑战。同时，对于一个网络中的新用户而言，他们可能已经长期参与其他在线社交网络。可以将这些用户的信息从这些成熟的源网络传输到我们重点关注的目标网络，以解决信息短缺问题。

## 7.4.1 新用户链接预测问题描述

链接预测的许多以前的工作都基于社交网络的快照，关注于预测将出现在所有用户中的潜在链接。这些作品平等地对待所有用户，并尝试预测网络中所有用户的社交链接。但是，在现实世界的社交网络中，每天都有许多新用户加入在线社交网络。在先前的工作中已经表明，网络中节点的年龄与其链接连接速率之间存在负相关关系。预测这些新用户的社交链接比网络中现有的活跃用户更为重要，因为它将给新用户留下良好的第一印象。第一印象通常会对新用户产生持久影响，并可能决定他/她是否将成为活跃用户。不好的第一印象可能会将新用户拒之门外。因此，重要的是向新用户提出有意义的建议，以创造良好的第一印象并吸引他们更多地参与进来。为简单起见，我们将长期活跃使用网络的用户称为“旧用户”。

新用户的链接预测问题不同于传统的链接预测问题。常规的有监督链接预测方法隐式或显式地假定信息均匀地分布在网络中的所有节点上，而不考虑用户的加入时间。在网络的一部分上训练的模型可以直接用于预测网络其他部分中的链接。但是，在现实世界的社交网络中，新用户的信息分布可能与旧用户的信息分布非常不同。新用户在网络中可能只有很少的活动，甚至没有活动（即，没有社交链接或其他辅助信息）；而老用户通常在网络中拥有丰富的活动和辅助信息。在图7.3和7.4中，我们分别展示了三个月内在Twitter和Foursquare上注册帐户的新用户和三个月前注册的旧用户的度分布。在图中，x轴表示节点度，y轴表示具有特定度的用户比例。我们观察到，在Foursquare和Twitter中，新用户和旧用户的社交链接分布完全不同。因此，基于诸如共同邻居之类的结构特征在老用户上训练的常规监督链接预测模型可能不适用于新用户。

对于新用户，链接预测中的另一个挑战性问题是，新用户拥有的信息可能非常少，甚至完全没有。由于缺少有关新用户的历史数据，基于单一网络的常规方法起不了作用。为了解决这个问题，我们需要从其他来源转移有关新用户的附加信息。如今，人们通常会参与多个社交网络以享受更多服务。例如，人们会加入Foursquare搜索附近的餐馆，与家人共进晚餐。同时，他们倾向于使用Facebook与朋友进行社交，并参与Twitter发布有关最新新闻的评论。通过帐户对齐方式，不同网络中同一用户的帐户可以被链接在一起。例如，当用户注册他的Foursquare帐户时，他们可以使用其Facebook或Twitter帐户登录Foursquare网络。根据第3.4.3节中的描述，同一用户帐户之间的此类链接被称为“锚链接”，这可以帮助在多个社交网络上对齐用户的帐户。例如，在图7.5中，两个网络中分别有许多用户。我们发现这两个网络中的帐户实际上是由6个不同的用户拥有的，并且我们在对应于同一用户的每对用户帐户之间添加了一个锚链接。通过定位链接，我们可以在其他网络中找到用户的相应帐户。

一个社交网络（即目标网络）中的新用户可能很长一段时间一直在使用其他社交网络（即源网络）。源网络中的这些用户帐户可以提供有关源网络中的新用户的附加信息。这些附加信息对于有关这些新用户的链接预测至关重要，尤其是当新用户在目标网络中活动很少或没有活动（即冷启动问题）时。

*例7.3* 例如，在图7.5中，我们有两个社交网络，即目标网络和源网络，它们具有对齐的用户帐户。 在目标网络中，有许多老用户，他们拥有丰富的社交链接和辅助信息，例如帖子，时空活动。 另外，目标网络中还有一些新用户，即用户ut1和ut2。这两个新用户刚刚在目标网络中创建了他们的帐户，还没有创建许多社交链接或辅助信息。但是，我们可以看到，基于这两个新用户的“锚链接”用户帐户us1和us2，源网络中具有关于他们的大量信息。我们可以利用源网络中新用户的信息来帮助提高目标网络中的链接预测性能。

为了解决这些问题，在本节中，我们将介绍[57]中提出的一种新型的有监督交叉对齐网络链接推荐方法，SCAN。 与以前的工作不同，SCAN从其他对齐的网络中提取异质特征，以改善目标网络中新用户的链接预测结果。SCAN详细分析了新用户和旧用户之间信息分布差异的问题，并提出了一种网络内个性化采样方法来适应这一差异。此外，SCAN还可以解决其他对齐源网络辅助下的冷启动社交链接预测问题。可以在SCAN中同时进行网络内和网络间的信息传递，以充分利用这些对齐网络中包含的信息，从而改善预测结果。

## 7.4.2 冷启动链接预测问题公式化

本节中研究的问题是针对新用户的社交链接预测。 我们将介绍一种基于对齐异质网络的有监督方法。令G =（（Gt，Gs），（At，s））是两个对齐的异质社交网络，其中Gt是目标网络，Gs是对齐的源网络.At，s表示Gt和Gs之间的锚链接集。我们希望预测目标网络中新用户的社交链接。令 Ut = Utnew ∪ Utold 是 Gt 中的用户集，其中Utnew和Utold分别是新用户和旧用户的集合，Utnew ∩ Utold = ∅。我们要预测的是新用户与所有其他用户之间潜在的社交链接的子集：L ⊆ Utnew × Ut。 换句话说，我们要构建一个函数f：L→{0,1}，该函数可以确定目标网络中是否存在与新用户相关的某些链接。

## 7.4.3 目标网络内的链接预测

根据在线社交网络中可用的异质信息，可以为第7.3.3.2节中介绍的社交链接抽取一组特征。接下来，我们将介绍如何使用这些特征来构建有监督的方法来预测目标网络中新用户的链接。在此之前，我们注意到在目标网络中，新用户的信息分布可能与旧用户的信息分布完全不同。但是，新用户和旧用户的信息都非常重要以至于都应该加以利用。在本节中，我们将分析目标网络中新用户和旧用户的信息分布的差异，并提出个性化的网内采样方法来处理老用户的信息以适应这些差异。然后，我们将通过利用在目标网络中老用户的采样信息来扩展传统的监督链接预测方法，以改进预测结果。

### 7.4.3.1 旧用户信息采样

使用目标网络来预测新用户的社交联系所固有的自然挑战是前面提到的新用户和旧用户的信息分布差异。为了解决此问题，SCAN模型提议通过使用网络内个性化采样方法来处理旧用户的信息，以此适应旧用户和新用户的子网。与[3]中研究的带有采样问题的链接预测完全不同，SCAN在该目标网络内而不是跨多个非对齐的同质网络进行个性化采样，该目标网络包含了异质信息。链接预测目标是目标网络中的新用户。通过对旧用户的子网进行采样，我们希望实现以下目标：

* *最大化相关性*: 我们旨在最大程度地利用旧用户子网和新用户子网的相关性，以适应异质目标网络中新用户和旧用户的信息分布差异。

* *信息多样性*：采样后旧用户信息的多样性仍然具有重要意义，应予以保留。

* *结构维持*：一些拥有稀疏社交链接的老用户在采样后应该有更高的生存概率，以保持他们的链接，从而维持网络结构。

令异质目标网络为Gt = {Vt，Et}，Ut = Utold ∪ Utnew ⊂ Vt是目标网络中的用户节点集（即，旧用户和新用户的集合）。个性化采样是在旧用户部分上进行的：Gtold = {Vtold，Etold}，其中每个节点都是使用采样率分布矢量δ=（δ1，δ2，...，δn）独立采样的，其中n = |Utold| ，∑n(i=1)δi = 1 且 δi ≥ 0。采样后，旧用户的异质子网表示为 ¯Gtold = {¯Vtold，¯Etold}。

老用户信息采样的主要目的是使老用户的子网与新用户尽可能相关。为了度量用户ui和异质网络 G 的相似性评分，我们定义相关性函数如下：

公式（7.16）

其中 U 是网络G的用户集，而S（ui，uj）衡量网络中用户ui和uj之间的相似性。 每个用户都有社交关系以及其他辅助信息，S（ui，u j）定义为这两个部分的相似性分数的平均值：

公式（7.17）

在我们的问题设置中，每个用户的辅助信息也可以分为3类：位置，时间和文本。 因此，将Saux（ui，u j）定义为这三个方面的均值。

有很多不同的方法可以度量这些辅助信息在不同方面的相似性，例如余弦相似度[16,53]。关于社会相似性，Jaccard的系数[17]可用于描述两个用户在其社会关系中的相似程度。在本部分中，我们将不讨论这些度量。

我们可以将抽样的旧用户网络与新用户网络之间的相关性定义为函数R（utold，Gtnew）的期望值：

公式(7.19)

其中向量s等于：

公式（7.20）

|utold| = n. 除了相关性，我们还需要确保可以保留采样的旧用户子网中信息的多样性。同样，它还包括辅助信息和社会关系的多样性。辅助信息的多样性由采样率δi决定，采样率δi可通过旧用户子网络上的平均辛普森指数[36]来定义。

公式（7.21）

关于社会关系的多样性，我们可以得到某一社会联系的存在概率（ui，uj）在抽样后与δi·δj成正比。因此，可以将被采样网络中社交链接的多样性定义为旧用户子网络中所有链接的平均存在概率。

公式（7.22）

其中|Etold,s| 是旧用户子网社交链接集合的大小，Ⅱ(ui,uj)是用来显示某一社交链接在采样前是否原来就存在的指示函数Ⅱ(ui,uj) → ｛0，1｝。例如，如果链接(ui.uj)是采样前原来就在目标网络之中，那么Ⅱ(ui,uj) = 1， 否则等于0。

通过同时考虑这两项，我们可以使采样的旧用户子网中的信息多样性成为这两个部分的平均多样性：

公式（7.23）

其中矩阵I|utold|是维度为|utold| X |utold|的单位矩阵， Atold是旧用户子网的邻接矩阵。

为确保原始旧用户子网的结构不被破坏，我们需要确保链接很少的用户也可以保留其链接。因此，我们可以添加正则项，以通过最大化下面的项来增大这些用户及其邻居的采样率：

公式（7.24）

其中M是对角矩阵，Mii = min {|Γ（u i）|，minuj∈Γ（u i）{|Γ（u j）|}}}，Γ（ui）**表示用户uj的邻居集（？？？）**。因此，如果一个用户或者他的邻居的链接很少，则该用户和他的邻居应具有较高的采样率，以至于能保留他们之间的链接。

*例子7.4* 例如，在图7.6中，我们有6个用户。要确定用户ut1的采样率，我们需要考虑其社会结构。我们发现，由于ut1的邻居ut2除ut1之外没有其他邻居。要保留ut1和ut2之间的社交联系，我们需要提高ut2的采样率。但是，链接（ut1， ut2）的存在概率也由用户ut1的采样率决定，这也需要提高。

结合多样性项和结构保留项，我们可以将采样后的正则化信息多样性定义为

公式（7.25）

其中 .......

δ的最佳值应该能够最大化新用户子网与旧用户子网的相关性，以及目标网络中旧用户信息的正则多样性

公式（7.26）

其中参数θ表示信息多样性正则项的权重。

### 7.4.3.2 TRAD

传统监督链接预测方法TRAD（Traditional Link Prediction）可以通过使用目标网络中的现有链接来训练分类器并将其应用到新用户的潜在社交链接分类。在方法TRAD中，仅使用目标网络，该目标网络由新用户和未采样的旧用户组成。为了克服目标网络中新用户和旧用户之间信息分布的差异，我们对其进行了一些修改得到了新方法：TRAD-PS（带有个性化采样的传统链接预测）。TRAD-PS包含两个步骤：（1）使用先前的方法对旧用户子网进行个性化采样；（2）使用与TRAD类似的技术基于采样网络预测链接。从理论上讲，通过使用目标网络中的信息，TRAD和TRAD-PS都挺有效的。但是，考虑到新用户实际上不可能拥有大量信息这一事实，TRAD和TRAD-PS会遭受长期的冷启动问题，这是由于缺乏表示这些新用户偏好的历史信息而引起的。当处理目标网络中根本没有信息的全新用户时，此问题将更加严重。

*例 7.5*  例如，在图7.7a中，用户ut1和ut2是目标网络中的两个新用户，他们与其他用户的社交链接很少，辅助信息也很少。我们无法获得有关这两个新用户的任何信息，而我们可以使用的信息是其他旧用户所拥有的信息。因此，TRAD和TRAD-PS预测的链接很难达到高质量。

为了处理这样的问题，我们将在下一节介绍一种同时使用对齐网络的方法。

## 7.4.4 冷启动链接预测

在当前的问题设置中，我们有两个对齐的社交网络，并且在上一节中提出的使用目标网络的方法在处理新用户时可能会遇到冷启动问题。在本节中，我们将介绍两种方法，利用对齐的源网络来帮助解决问题并改善预测结果。

### 7.4.4.1 NAIVE（朴素？？）

假设我们在目标网络中有一个新用户uti，使用对齐源网络为用户uti推荐社交链接的一种简单的方法是向其推荐与对齐源网络中该用户的对齐帐户usi相关的所有相应社交链接。基于这种直觉，可以应用[57]中提出的冷启动链接预测方法NAIVE（朴素链接预测）。为了阐明NAIVE在现实中的工作方式，接下来我们将举一个例子。在此之前，我们将介绍一个新的项：伪标签[57]，来表示对齐的源网络中存在相应的链接。

**定义 7.1 （伪标签）** 目标中的链接（uti，utj）的伪标签表示对齐的源网络中存在其相应链接（usi，usj），如果（usi，usj）存在，则为1，否则为0。

*例 7.6* 例如，在图7.7b中，为了决定是否在目标网络中推荐ut1或ut2，我们可以借助锚链接，在对齐源网络中找到他们的对齐帐户：us1和us2，以及他们的社交链接：（us1，us2）。我们发现us1和us2是对齐源网络中的好友，并且链接（us1，us2）存在于对齐源网络中。因此，链接（ut1，ut2）的伪标签为1，在目标网络中，我们可以将ut2推荐给ut1。这就是为什么通过NAIVE方法预测ut1和ut2之间的社交联系存在的原因。图7.7b中的其他链接可以用类似的方式进行预测。

NAVIE方法非常简单，即使新用户是全新的，也可以很好地解决冷启动链接预测任务，这意味着使用此方法可以克服冷启动问题。但是，它仍然可能存在一些缺点：（1）不同网络的社交结构并不总是相同的，这将大大降低NAIVE的性能；（2）NAIVE仅利用源网络中这些新用户的社交链接信息，而忽略所有其他信息。

### 7.4.4.2 SCAN

为了克服上面提到的所有这些缺点，在[57]中提出了一种新的方法SCAN（带有个性化采样的监督交叉对齐网络链接预测）。如图7.7c所示，它可以使用目标网络和对齐源网络中都存在的异质信息，并且该信息跨两个对齐的社交网络来构建。借助锚链接的优势，我们可以在对齐源网络中准确找到用户的对齐帐户及其信息。如果两个对齐网络被同时使用，则可以从对齐网络中抽取出不同种类的特征。

为了使用多个网络，为对齐网络中的对应链接抽取的这些特征向量将合并为扩展的特征向量。扩展的特征向量与目标网络中的标签一起用于构建跨网络分类器，以确定目标网络中与这些新用户相关的社交链接的存在。这就是SCAN方法的工作方式。SCAN相当稳定，并且可以克服冷启动问题，原因是对齐源网络中所有这些用户的信息不会随着目标网络的变化而发生很大变化，而我们从他/她在对齐源网络中留下的信息中能得到表明这些新用户偏好的信息。由于SCAN还使用了目标网络中的旧用户信息，因此还进行了个性化采样以预处理目标网络中的旧用户信息。

除了前面提到的特征外，SCAN还利用了NAIVE方法所使用的信息，即之前定义的伪标签，将其视为额外的特征。

* **额外特征**： SCAN使用社交链接的伪标签作为抽取特征来表示对齐源网络中相应链接的存在。

与使用NAIVE的SCAN相比，SCAN具有许多优点：（1）SCAN利用了多种类别的信息；（2）SCAN可以通过将旧用户网络中隐藏的信息纳入训练集中来利用这些信息；（3）SCAN并不依赖于不同网络中的社会关系相同这一假设，实际上这一假设非常有风险的。

与TRAD和TRAD-PS相比，SCAN可以解决冷启动问题，因为它可以访问其他对齐源网络中的这些新用户所拥有的信息。与TRAD和TRAD-PS相似，如果这些新用户不是很新，则使用这些新用户的信息，并且在网络内知识转移之前，也使用网络内个性化采样方法对目标中其他老用户的信息进行预处理。

# 7.5 基于间谍技术的网络间PU链接预测

除了单个目标网络中的链接预测问题外，还对同时存在于多个对齐的在线社交网络中的并发链接预测进行了一些研究工作。 在之前介绍的监督链接预测模型中，在所有不存在的社交链接中，一个链接的子集可以被识别并标记为负样例。但是，在现实世界中，标记永远不会形成的链接可能非常困难，几乎是不可能的。在本节中，我们将研究采用PU学习的跨网络并发链接预测问题，并介绍[59]中提出的基于间谍技术的链接预测的方法MLI。

## 7.5.1 跨网络并发链接预测问题

传统的链接预测问题旨在预测一个网络中的单一链接，而且已经研究了很多年。迄今为止，已经提出了数十种不同的链接预测方法。传统的链接预测方法通常假定网络中存在足够的信息来为每对节点计算特征（例如，公共邻居）。但是，正如[19,58]中提出的那样，由于“新网络”问题，在处理包含很少信息的社交网络时，可能会严重违反这一假设[59]。

当在线社交网络分支成新的地理区域或社交群体中时，可能会遇到新的网络问题，并且新网络中的信息可能过于稀疏而无法建立有效的链接预测模型。同时，最近的著作[19,57,58]注意到，如今的用户可以同时参与多个在线社交网络。参与新网络的用户可能会长时间使用其他发达的网络，其中他们可能拥有大量的异质信息。为了解决新的网络问题，一些论文[57，58]提出从发达的网络中传输信息，以克服新网络中信息短缺的问题。正式地，共享某些共同用户的网络被定义为“部分对齐网络”，而在这些对齐的网络上共享的公共用户被称为“锚用户”[19,57,58]。而未共享的用户被称为3.4.3节中介绍的对齐网络之间的“非锚定者”。

通过“锚用户”对齐的社交网络可以共享公共信息。同时，如[28,50]中所提出的，为提供不同服务而构建的不同的在线社交网络通常具有不一样的特征。此外，各种不同社交网络中的信息可能具有不同的分布[28,50]，在[59]中被称为“网络差异问题”。“网络差异问题”将成为跨多个部分对齐网络进行链接预测的障碍，因为从其他对齐网络传输来的信息可能会降低在给定网络中的预测性能。

在本节中，我们要同时预测多个部分对齐网络中社交链接的形成，这被正式地定义为多网络链接预测问题[59]。正如本节开头所介绍的，多网络链接预测问题在现实世界的社交网络中可以有非常广泛的应用。因此，本节中研究的多网络链接预测问题对于多个部分对齐的社交网络非常重要。

由于以下原因，本节中研究的多网络链接预测问题也非常具有挑战性：（1）缺乏特征；（2）网络部分对齐问题；（3）网络差异问题；以及（4）多网络的同时链接预测。为了解决多网络链接预测问题中的所有上述挑战，本节将介绍[59]中提出的新型链接预测框架MLI。受到Sun关于元路径（mata path）作为一种捕获节点相似性的方法[40]的研究的启发（这些节点在异质信息网络中不直接连接），MLI探索了元路径概念以生成有用的特征。 MLI不仅可以借助“网络内元路径”生成网络内特征，还可以借助“网络内元路径”通过锚链接生成网络间特征。通过明智地选择“网络间元路径”，MLI可以利用多个部分对齐网络之间的共性，也包含来自网络差异的潜在负转移。这些衍生的特征可以大大提高MLI在预测每个网络的链接方面的有效性。此外，MLI是解决多网络链接预测问题的通用链接形成预测框架，并且不同网络中的链接预测任务可以相互帮助。

## 7.5.2 并发链接预测形式化

令G（1），G（2），...，G（n）表示n个不同的异质在线社交网络，其中它们之间的锚链接集可以表示为A（1,2），A（1,3） ），...，A（n-1，n）。G（i）的用户集和现有社交链接集可以分别表示为U（i）和E（i）u，u。在网络G（i）中，所有现有链接都是已形成的链接，因此，G（i）中已形成的链接可以表示为P（i），其中P（i）= E（i）u，u。 此外，未连接的用户对的大集合称为未连接的链接U（i），并可从网络G（i）中抽取出来：¯U（i）= U（i）× U（i）\ P（i）。但是，我们无法从该网络获得关于永远不会形成的链接的信息。利用已形成的链接集P（i）和未连接的链接集¯U（i），可以将链接形成预测问题表述为PU链接预测问题。

正式地，令{P（1），...，P（n）}，{¯U（1），...，¯U（n）}和{L（1），...，L（n ）}是分别已形成链接集合，未连接链接集合和G（1），G（2），...，G（n）中预测的链接集合。利用G（1），G（2），...，G（n）中已形成和未连接的链接，我们可以将多网络链接预测问题看作并发PU链接预测问题来解决。

在以下小节中，我们将介绍MLI以解决多网络链接预测问题。本节包括3个部分：（1）基于社交元路径的特征提取和选择；（2）PU链接预测；（3）多网络并发链接预测框架。

## 7.5.3 社交元路径定义和选择

在讨论链接预测方法之前，我们将首先在本小节中介绍从部分对齐网络中抽取的特征。MLI中的特征抽取基于第3.5节中定义的元路径。根据本节研究的网络架构，如图7.8所示，我们可以为网络定义许多不同种类的同质和异质网络内部社交元路径，其物理意义和符号如下：

**同质网络内社交元路径**

...

**异质网络内社交元路径**

...

**基于元路径的社交元路径**：这些元路径实际上可以覆盖连接网络中用户的大量路径实例。形式上，我们将节点n（或链接l）表示为网络中节点类型T（或链接类型R）的一个实例，表示为n ∈ T（或l ∈ R）。指示函数（if a∈A 1，否则0）可以检查节点/链接 a 是否为网络中节点/链接类型A的实例。为了在提取网络中社交链接的特征时考虑未连接链接的影响，可以将基于网络内社交元路径特征定义如下：

**定义 7.2 (基于网络内社交元路径的特征)** 对于给定的链接（u，v），基于网络中元路径Φ= T1 R1-→T2 R2-→···Rk-1 ---→Tk抽取的特征被定义为网络中u和v之间形成的路径实例的期望数量：

公式（7.27）

其中p（ni，n i + 1）= 1.0 if（ni，n i + 1）∈Eu，u否则p（ni，n i + 1）表示将在第7.5.4节中介绍的链接形成概率（ni，n i + 1 ）。

基于Φ= {Φ1，...，Φ6}用MLI提取的特征被称为基于网络内社交元路径的社交特征。（Φ0仅在以下小节中使用。）

**网络间社交元路径**：当网络非常新时，由于网络中几乎没有连接，因此基于网络内社交元路径提取的特征可能非常稀疏。

*例 7.7* 例如，在图7.9中，考虑我们想要预测网络G（1）中的社交链接（A（1），B（1））是否会形成。仅基于网络内社交元路径，针对链接（A（1），B（1））提取的特征向量将为0。但是，我们发现，借助各种网络间的路径，A（1）和B（1）实际上可以相关，例如B（1）→B（2）→A（2）→A（1），B（1）→B（2）→F（2）→A（2）→ A（1）和B（1）→B（2）→G（2）→A（2）→A（1）。

通过遵循这一思想，MLI提出使用锚元路径和网络间社交元路径从对齐的网络传输有用的信息，其正式定义在第3.5节中。在MLI中，我们主要关注以用户为起点和终点的网络间元路径，它们被称为网络间社交元路径。令Υ（U（i），U（j））表示在网络G（i）和G（j）之间定义的锚元路径。MLI中使用的4种特定的网络间社交元路径包括：

。。。

其中 Φ(U(i),U(i)) ∪ Φ0(U(i),U(i)) = {Φ0(U(i),U(i)), . . . , Φ6(U(i),U(i))} 表示之前介绍的网络G(i)中的7个网络间社交元路径。

令 Ψ = {Ψ1,Ψ2,Ψ3,Ψ4}. Ψ是一个全面的网络间社交元路径集，基于Ψ抽取的特征可以为其他对齐网络中的锚用户和非锚用户传输信息。

*例 7.8* 例如，在图7.9中，通过跟随路径“ B（1）→B（2）→A（2）→A（1）”，我们可以从锚用户B（1）转到另一个锚用户A（ 1）并且这样的路径是Ψ1（U（1），U（1））的实例；通过跟随路径C（1）→A（1）→A（2）→D（2）→D（1），我们可以从非锚点用户C（1）到锚用户D（1），后者是Ψ2（U（1），U（1））的实例；此外，通过跟随路径C（1）→A（1）→A（2）→B（2）→B（1）→E（1），我们可以从非锚点用户C（1）到另一个非锚用户E（1），它是Ψ4（U（1），U（1））的实例。

**社交元路径选择**：正如第7.5.1节中介绍的那样，从对齐网络传输的信息有助于改善给定网络中的链接预测性能，但也会产生误导，这被称为网络差异问题。为了解决网络差异问题，MLI提出：从特征向量中排序和选择前K个特征，该特征向量是基于网络内和网络间社交元路径，[xΦ，xΨ]，从多个部分对齐异质网络中抽取出来的。

令变量 Xi ∈ [xΦ，xΨ] 为基于{Φ，Ψ}中元路径抽取的特征，变量 Y 是标签。 P（Y = y）表示训练集中的链接具有标签y的先验概率，以及P（Xi = x）表示特征Xi具有值x的频率。与信息论相关的度量——共有信息（mi），[43]被用作排序标准：

公式（7.28）

令 [¯xΦT，¯xΨT]T 是从 [xΦT，xΨT]T 中选择的前K个mi分数的特征。在下一个小节中，我们将使用选定的特征向量 [¯xΦT，¯xΨT]T 建立一个新颖的PU链接预测模型。

## 7.5.4 基于间谍技术的PU链接预测

在本小节中，我们将首先介绍一种解决单个网络中的PU链路预测问题的方法。如第7.5.2节中所述，从给定的网络（例如G）中，我们可以获得两组不相交的链接集：连接的（即，形成的）链接P和未连接的链接U。为区分这些链接，我们定义了一个新的概念“连接状态”z，以表示链路是在网络G中连接（即已形成）还是未连接。对于一个给定的链接l，如果l在网络中是连接的，则z（l）= + 1；否则，z（l）= -1。因此，我们可以使P和U中的链接的“连接状态”为：z（P）= + 1和z（¯U）= -1。

除了“连接状态”之外，网络中的链接还可以有其自己的“标签”y，它们可以表示是将会在网络中形成链接，还是将永远不形成链接。对于给定的链接l，如果l已经形成或将要形成，则y（l）= +1；否则，y（l）= -1。类似地，我们可以使P和¯U中的链接的“标签”为：y（P）= +1，但是y（¯U）可以为+1或-1，因为¯U包括了已形成和永远不会形成的链接。

通过使用P和U作为正负训练集，我们可以建立链路连接预测模型Mc，该模型可以用于预测原始网络中是否存在链接，即链路的连接状态。令l为待预测的链接，通过应用Mc对l进行分类，我们可以得出l的连接概率为：

**定义 7.3（链接概率）** 链接l的连接状态被预测为连接的概率（即z（l）= + 1）定义为链接l的连接概率：p（z（l）= +1 | x（l）），其中x（l）= [xΦ（l），xΨ（l）]。

同时，如果我们可以从网络中获得一组“永远不会形成”的链接，即“-1”链接，这些链接可与P（“+1”链接）一起用于构建链接形成预测模型Mf。 这里，我们可以使用模型Mf来获得l的形成概率为：

**定义 7.4（形成概率）** 链接l的标签被预测为形成或将要形成的概率（即y（l）= + 1）被定义为链接l的形成概率：p（y（l）= +1 | x（l ））。

但是，从网络中，我们没有有关“永远不会形成的链接”（即“ -1”链接）的信息。因此，要计算在7.52节提出的我们要获得的潜在链接的形成概率可能非常具有挑战性。同时，现有研究[11]证明了链路l的连接概率与形成概率之间的相关性为：

公式7.29

换句话说，对于连接概率较低的链接，其形成概率也将相对较低。该规则可用于从网络中提取链接，该链接更有可能是可靠的“-1”链接。用P和U构建的链接连接预测模型Mc可以用于对U中的链接进行分类，以提取可靠的负链接集。

**定义 7.5（可靠负链接集）** 未连接链接集合U中的可靠负链接是那些由链接连接预测模型Mc预测的连接概率低于阈值∈[0,1]的链路：

公式7.30

现在已经有提出了一些基于启发式的方法来设置最佳阈值，例如，[24]中提出的间谍技术。如图7.10所示，我们在P中随机选择一个子集作为间谍，SP，其比例受s％控制（s％= 15％作为[59]中引入的默认采样率）。集合（P\SP）和（¯U ∪ SP）用作预测模型，Ms，的正训练集和负训练集。通过将Ms应用于分类（¯U ∪ SP）中的链接，我们可以得出它们的连接概率为：

公式7.31

并且参数E设置为SP中间谍链接的最小连接概率：

公式7.32

利用提取出的可靠负链接集RN，我们可以使用基于分类的链接预测方法解决PU链接预测问题，其中P和RN分别用作正训练集和负训练集。同时，当将构建的模型应用到L（i）中的链接预测时，它们的最佳标签，即ˆY（i），应该是那些可以最大化以下形成概率的标签：

公式7.33

其中 y(L(i)) = Y(i) 表示 L(i) 中的链接拥有标签y(i)

## 7.5.5 多网络并发的PU链接预测框架

这个部分介绍的方法MLI是一个通用的链接预测框架，可用于同时预测n个部分对齐的网络中的社交链接。当提到第7.5.2节中的n个部分对齐的网络时，网络G（1），G（2），...，G（n）的潜在链接{L（1），L（2），...，L（n）}的最佳标签将是：

公式7.34

上述目标函数的求解非常复杂，在[59]中，MLI利用以下公式交替地更新一个变量（例如Y（1））和固定其他变量（例如Y（2），...，Y（ n）来获得解：

公式7.35

框架MLI的结构如图7.11所示。当预测网络G（i）中的社交链接时，MLI可以基于从G（i）中提取的网络内社交元路径xΦ，以及跨G（1），G（2），...，G（i-1），G（i + 1），...，G（n）提取的网络间社交元路径xΨ，来为P（i），¯U（i）和L(i)中的链接抽取特征。将特征向量xΦ（P），xΦ（¯U）和xΨ（P），xΨ（¯U）以及P和¯U中的链接的标记y（P），y（¯U）传递给PU链接预测模型M（i）和元路径选择模型MS（i）。利用模型M（i）预测的L（i）中链接的形成概率将通过用新预测的形成概率替换L（i）的权重来更新网络。L（i）中这些潜在链接的初始权重设置为0（即定义7.2中提到的链接的形成概率）。在完成对G（i）的这些步骤后，我们将开始对G（i + 1）进行类似的操作。我们依次预测G（1）到G（n）的链接，直到所有这些网络的结果收敛为止。
